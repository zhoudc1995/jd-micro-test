System.register("chunks:///_virtual/AliLogManager.ts",["cc","./EventTrackingManager.ts","./MainDataManager.ts","./MainMsgType.ts","./MicroApp.ts"],(function(n){var i,a,o,e,t,r;return{setters:[function(n){i=n.cclegacy},function(n){a=n.EventTrackingManager},function(n){o=n.MainDataManager},function(n){e=n.AliLogMsgType,t=n.MainMsgType},function(n){r=n.MicroApp}],execute:function(){i._RF.push({},"93cdeWY9KdBwIwYNWtwAD+Y","AliLogManager",void 0);var g=function(){function n(){}n.getInstance=function(){return null===this._instance&&(this._instance=new n),this._instance};var i=n.prototype;return i.reportAliLog=function(n,i){void 0===i&&(i={}),window.aliLogMsg&&window.aliLogMsg.info(n,i)},i.mainProcessLog=function(n,i){void 0===i&&(i=""),this.reportAliLog(e.mainProcessEvent,{eventName:n,data:i})},i.commonLog=function(n,i){void 0===i&&(i=""),this.reportAliLog(e.commonLog,{eventName:n,data:i})},i.warn=function(n,i){void 0===i&&(i=""),window.aliLogMsg&&window.aliLogMsg.warn(e.warnLog,{eventName:n,data:i})},i.error=function(n,i){void 0===i&&(i=""),window.aliLogMsg&&window.aliLogMsg.error(e.errorLog,{eventName:n,data:i})},i.reportDarkTag=function(n){},i.reportEventTracking=function(n){var i;(n.engine_version="3",o.isFromMccPlayer()||o.isFromClassPlayer())?r.dispatch(t.MicroApp_send_eventTracking,n):(n.live_type="NON_MCC_MODE",n.times_tamp=Date.now(),n.main_trace_id=(null==(i=window.gameEngineCustomData)||null==(i=i.gameMain)?void 0:i.main_trace_id)||"",a.reportEventTracking(n));window.isShowEventTrackingLog&&console.log("====== reportEventTracking ====== param: "+JSON.stringify(n))},n}();g._instance=null;n("AliLogManager",g.getInstance());i._RF.pop()}}}));

System.register("chunks:///_virtual/ConstValue.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"c440amWAm5BZ4f7Caaf0Vu1","ConstValue",void 0);e("EZipProcessType",function(e){return e.webp="webp",e.quality="quality",e.normal="normal",e}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/EventTrackingManager.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"e65b16MZctAxrT6F1494P+D","EventTrackingManager",void 0);var e=function(){function n(){}return n.getInstance=function(){return null===this._instance&&(this._instance=new n),this._instance},n.prototype.reportEventTracking=function(n){void 0===n&&(n={}),window.eventTrackingMsg&&window.eventTrackingMsg.tracking("cocosEventTracking",n)},n}();e._instance=null;n("EventTrackingManager",e.getInstance());t._RF.pop()}}}));

System.register("chunks:///_virtual/GameMain.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env","./AliLogManager.ts","./MainDataManager.ts","./MainMsgType.ts","./MainNetWork.ts","./MicroApp.ts","./ResourceLoadManager.ts"],(function(e){var a,r,o,n,t,i,s,l,m,c,d,u,f,h,g,p,L,F,P,_,v,y,M,R;return{setters:[function(e){a=e.applyDecoratedDescriptor,r=e.inheritsLoose,o=e.initializerDefineProperty,n=e.assertThisInitialized,t=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,m=e.Camera,c=e.Node,d=e.log,u=e.Component,f=e.Prefab,h=e.instantiate,g=e.assetManager},function(e){p=e.PREVIEW},function(e){L=e.AliLogManager},function(e){F=e.MainDataManager},function(e){P=e.EResourceLoadWay,_=e.MainMsgType,v=e.ELoadFailedTypeDetail},function(e){y=e.MainNetWork},function(e){M=e.MicroApp},function(e){R=e.ResourceLoadManager}],execute:function(){var C,b,G,E,A,T,B,I,S,D,N;s._RF.push({},"62fd9tWWbFFp5PoQK8PGvaW","GameMain",void 0);var k=l.ccclass,w=l.property;e("GameMain",(C=k("GameMain"),b=w(m),G=w(m),E=w(c),A=w(c),C((I=a((B=function(e){function a(){for(var a,r=arguments.length,t=new Array(r),i=0;i<r;i++)t[i]=arguments[i];return a=e.call.apply(e,[this].concat(t))||this,o(a,"mainCamera",I,n(a)),o(a,"screenShotCamera",S,n(a)),o(a,"cameraParent",D,n(a)),o(a,"baffleWall",N,n(a)),a._isLoadedFrameAgain=!1,a._isLoadedFrameResourceAgain=!1,a}r(a,e);var s=a.prototype;return s.onLoad=function(){var e,a=this,r=location.protocol,o="http:"===r||"https:"===r;if(L.mainProcessLog("主包加载完成","GameMain onLoad: isRemote: "+o),L.reportEventTracking({metric_type:"loading",trace_id:(null==(e=window.gameEngineCustomData)||null==(e=e.gameMain)?void 0:e.trace_id)||"null",module_type:"gameMain",sub_version:F.mainVersion,name:"load_main",act:"end",desc:"主包加载-完成",load_source:o?P.online:P.offline}),M.addDataListener(),F.mainCamera=this.mainCamera,F.screenShotCamera=this.screenShotCamera,F.baffleWall=this.baffleWall,F.setGameFPS(30),F.isFromMcc()||p)L.mainProcessLog("通知MCC主包加载完成","dispatch mainGameInitDone"),M.dispatch(_.MicroApp_send_mainGameInitDone,null,(function(e){L.mainProcessLog("MCC返回框架包数据","params: "+JSON.stringify(e)),R.isLoadBundleFromLocal=e.isLoadFromLocal,R.isLoadResourceFromLocal=e.isLoadFromLocal,R.localRootPath=e.localRootPath,R.cdnRootPathList=e.cdnRootPathList,F.frameVersion=e.frameVersion,e.initParams&&e.initParams.gameFps&&F.setGameFPS(e.initParams.gameFps),a.loadFrameBundle(e.frameUrl)}));else if("slides"===F.getUrlParamByKey("platformFlag"))this.loadGameFromUrl();else if(F.isFromGameShell())this.loadGameFromGameShell();else{R.isLoadBundleFromLocal=!0,R.isLoadResourceFromLocal=!1,R.localRootPath="./assets",R.cdnRootPathList=[y.FILE_REMOTE_URL];var n=F.getFrameBundlePath();L.mainProcessLog("非MCC加载，主包加载成功","framePath: "+n),this.loadFrameBundle(n)}this.node.on(c.EventType.TRANSFORM_CHANGED,this.updateCamerasOrthoHeight,this)},s.onEnable=function(){this.updateCamerasOrthoHeight()},s.loadGameFromUrl=function(){var e=t(i().mark((function e(){var a=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Promise.all([y.getGameCdnPathList(),y.getGameTemplateBundleInfo(F.templateId)]).then((function(e){var r,o,n=e[0],t=e[1];L.mainProcessLog("管理后台加载游戏，获取游戏包信息成功","gameInfo: "+t),F.gameBundleInfo=t,R.isLoadBundleFromLocal=!1,R.isLoadResourceFromLocal=!1,R.cdnRootPathList=[].concat(n);var i=(null==t||null==(r=t.framePackageResourceDto)?void 0:r.packOssPath)+"/"+(null==t||null==(o=t.framePackageResourceDto)?void 0:o.customIdentityId);a.loadFrameBundle(i)})).catch((function(e){L.error("管理后台加载游戏，获取游戏包信息失败","err: "+e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s.loadGameFromGameShell=function(){L.mainProcessLog("通过game-shell加载游戏"),R.isLoadBundleFromLocal=!1,R.isLoadResourceFromLocal=!1,R.cdnRootPathList=[y.FILE_REMOTE_URL];var e="/packageResources/common/frame/"+F.frameVersion+"/frame";this.loadFrameBundle(e)},s.updateCamerasOrthoHeight=function(){var e=this;this.cameraParent&&this.cameraParent.getComponentsInChildren(m).forEach((function(a){a!==e.mainCamera&&a!==e.screenShotCamera&&(a.orthoHeight=e.mainCamera.orthoHeight)}))},s.loadFrameBundle=function(e){var a=this;d("开始加载框架子包 bundlePath: "+e),F.frameTraceId=this.randomString(20),L.mainProcessLog("开始加载框架子包","bundlePath: "+e+"; retry: "+this._isLoadedFrameAgain),L.reportEventTracking({metric_type:"loading",trace_id:F.frameTraceId,module_type:"gameFrame",name:"load_frame",sub_version:F.frameVersion,act:"start",business_identity:"coverageRate",package_resource_type:"common",custom_identity_id:"frame",desc:"框架加载-开始"});var r=function(e){L.reportEventTracking({metric_type:"loading",trace_id:F.frameTraceId,module_type:"gameFrame",name:"load_frame",sub_version:F.frameVersion,act:"fail",desc:"框架加载-失败",fail_type:"valid",fail_type_detail:v.resourceLoadFailed,fail_msg:""+e}),M.dispatch(_.MicroApp_send_frameLoadFailed,{msg:"框架加载-失败,"+e})};R.loadBundle(e).then((function(o){d("框架子包加载成功"),L.mainProcessLog("框架子包加载成功");var n=function(n,i){L.mainProcessLog("加载框架FrameNode失败"),n&&!a._isLoadedFrameResourceAgain?(L.mainProcessLog("加载框架FrameNode失败, 重试一次"),a._isLoadedFrameResourceAgain=!0,t(5)):a._isLoadedFrameAgain?(r("加载框架节点失败，err: "+i),F.showErrorTips("交互游戏加载失败","请检查网络后刷新重试。")):(L.mainProcessLog("加载框架FrameNode失败, 切在线重新加载bundle"),o.releaseAll(),g.removeBundle(o),a._isLoadedFrameAgain=!0,R.setLoadResourceFromRemote(e,!1),a.loadFrameBundle(e))},t=function(e){var r;void 0===e&&(e=1);var t=-1!==(null==o||null==(r=o.base)?void 0:r.indexOf("http")),i={maxRetryCount:0,xhrTimeout:t?3e3*e:2e3};R.loadBundleDir(o,"res/",i).then((function(e){try{var r=o.get("res/FrameNode",f),i=h(r);a.node.addChild(i),i.setPosition(0,0,10),L.mainProcessLog("框架节点FrameNode创建成功")}catch(e){d("框架节点FrameNode创建失败, err: "+e),L.error("框架节点FrameNode创建失败","err: "+e),n(t,e)}})).catch((function(e){d("加载框架包内资源失败, err: "+e),L.error("加载框架包内资源失败","err: "+e),n(t,e)}))},i=a._isLoadedFrameAgain?5:1;t(i)})).catch((function(e){r(e),F.showErrorTips("交互游戏加载失败","请检查网络后刷新重试。")}))},s.setUrlParams=function(e){for(var a in e)F.setUrlParam(a,e[a])},s.randomString=function(e){void 0===e&&(e=14);for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefjhijklmnopqrstuvwxyz1234567890",r="",o=0;o<e;++o)r+=a.charAt(Math.floor(Math.random()*a.length));return r},a}(u)).prototype,"mainCamera",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=a(B.prototype,"screenShotCamera",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=a(B.prototype,"cameraParent",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=a(B.prototype,"baffleWall",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=B))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AliLogManager.ts","./ConstValue.ts","./EventTrackingManager.ts","./GameMain.ts","./MainDataManager.ts","./MainMsgType.ts","./MainNetWork.ts","./MicroApp.ts","./ResourceLoadManager.ts","./debug-view-runtime-control.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainDataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AliLogManager.ts"],(function(e){var t,r,i,a;return{setters:[function(e){t=e.extends},function(e){r=e.cclegacy,i=e.game},function(e){a=e.AliLogManager}],execute:function(){r._RF.push({},"5652bI24fFLlbHfFX87se0w","MainDataManager",void 0);var s=e("SceneRatio",function(e){return e.R4x3="1",e.R16x9="2",e}({})),n=function(){function e(){this._urlParams=null,this._frameBundlePath="frame",this.gameBundleInfo={},this.staticResUrl="",this.templateId="",this.gameId="",this.gameTemplateVersion="1.0.0",this.gameTemplatePackageName="",this.frameVersion="1.0.0",this.publicModelVersion="1.0.0",this.publicModelPackageName="",this.curPageId="",this.isCurPageReportedClick=!1,this.sceneRatio=s.R4x3,this.mainVersion="",this.traceId="",this.isEditorConsume=!1,this.frameTraceId="",this.mainCamera=null,this.screenShotCamera=null,this.baffleWall=null}e.getInstance=function(){return null===this._instance&&(this._instance=new e,this._instance.initUrlParams()),this._instance};var r=e.prototype;return r.initUrlParams=function(){this._urlParams||(this._urlParams=new Object);var e=location.search;if(-1!=e.indexOf("?"))for(var t=e.substring(1).split("&"),r=0;r<t.length;r++)this._urlParams[t[r].split("=")[0]]=decodeURIComponent(t[r].split("=")[1]);if(window.initParams)for(var i in window.initParams)this._urlParams[i]=window.initParams[i];this.templateId=this.getUrlParamByKey("templateId"),this.gameId=this.getUrlParamByKey("coursewareId")||this.getUrlParamByKey("gameId"),/^\d+$/.test(this.templateId)||(this.templateId=""),/^\d+$/.test(this.gameId)||(this.gameId=""),this.gameTemplateVersion=this.getUrlParamByKey("gameTemplateVersion")||"1.0.0",this.gameTemplatePackageName=this.getUrlParamByKey("gameTemplatePackageName")||"",this.frameVersion=this.getUrlParamByKey("frameVersion")||"1.0.0",this.publicModelVersion=this.getUrlParamByKey("publicModelVersion")||"1.0.0",this.publicModelPackageName=this.getUrlParamByKey("publicModelPackageName")||"public-model-custom";var a=window.sceneRatio;for(var n in s)if(s[n]==a){this.sceneRatio=s[n];break}this.mainVersion=window.mainVersion},r.getUrlParams=function(){return this._urlParams},r.setUrlParam=function(e,t){this._urlParams[e]=t},r.getUrlParamByKey=function(e){return this._urlParams[e]},r.isFromMcc=function(){var e=window.eventCenterForCocos;return!!e||this.isFromObserver()||this.isFromIframe()||this.isFromClassPlayer()},r.isFromMccPlayer=function(){return!!window.eventCenterForCocos},r.isFromObserver=function(){return"observer"===this.getUrlParamByKey("from")},r.isFromIframe=function(){return"iframe"===this.getUrlParamByKey("from")},r.isFromGameShell=function(){return"game-shell"===this.getUrlParamByKey("platform")},r.isFromClassPlayer=function(){return"classPlayer"===this.getUrlParamByKey("from")},r.isMainClass=function(){return this.isFromClassPlayer()||"ledu"===this.getUrlParamByKey("classType")||"ledu"===window.classType},r.isFromFullZip=function(){var e=window.location.protocol;return"http:"!==e&&"https:"!==e&&!(this.isFromMcc()||"slides"===this.getUrlParamByKey("platformFlag")||this.isFromGameShell())},r.isFromEditorProject=function(){return this.isFromEditorProduction()||this.isFromEditorConsume()||this.isFromEditorPreview()},r.isFromEditorProduction=function(){return"editor"===this.getUrlParamByKey("editorOpenType")},r.isFromEditorPreview=function(){return"preview"===this.getUrlParamByKey("editorOpenType")},r.isFromEditorConsume=function(){return this.isEditorConsume},r.getFrameBundlePath=function(){return this._frameBundlePath},r.setGameFPS=function(e){!e||"string"!=typeof e&&"number"!=typeof e||("string"==typeof e&&(e=Number(e)),isNaN(e)||e<=0||(i.frameRate=e))},r.setBaffleWallActive=function(e){this.baffleWall&&(this.baffleWall.active=e)},r.showErrorTips=function(e,t){a.commonLog("showErrorTips",{title:e,content:t});var r=document.getElementById("error-tips-full");if(r){r.style.display="flex";var i=r.querySelector("#error-tips-title"),s=r.querySelector("#error-tips-content");i&&(i.innerHTML=e||""),s&&(s.innerHTML=t||"")}},r.closeErrorTips=function(){a.commonLog("closeErrorTips");var e=document.getElementById("error-tips-full");e&&(e.style.display="none")},r.objectAssignFunction=function(){return t({},{a:1,b:2},{c:3,d:4})},e}();n._instance=null;e("MainDataManager",n.getInstance());r._RF.pop()}}}));

System.register("chunks:///_virtual/MainMsgType.ts",["cc"],(function(e){var o;return{setters:[function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"dda94AC3GhMgoVeTsZYBzHS","MainMsgType",void 0);var n=e("MainMsgType",(function(){}));n.MicroApp_send_mainGameInitDone="mainGameInitDone",n.MicroApp_send_eventTracking="eventTracking",n.MicroApp_send_frameLoadFailed="frameLoadFailed",n.MicroApp_send_subGameLoadFailed="subGameLoadFailed";var a=e("AliLogMsgType",(function(){}));a.DarkTagInfo="DarkTagInfo",a.mainProcessEvent="mainProcessEvent",a.warnLog="warnLog",a.errorLog="errorLog",a.commonLog="commonLog";e("ELoadFailedTypeDetail",function(e){return e.pageChanged="pageChanged",e.resourceLoadFailed="resourceLoadFailed",e.notSupportWebGL="notSupportWebGL",e.noEnd="noEnd",e}({})),e("EResourceLoadMode",function(e){return e.normalLoad="normalLoad",e.preloaded="preloaded",e.halfPreloaded="halfPreloaded",e}({})),e("EResourceLoadWay",function(e){return e.offline="offline",e.online="online",e.hybrid="hybrid",e}({}));o._RF.pop()}}}));

System.register("chunks:///_virtual/MainNetWork.ts",["cc","./AliLogManager.ts","./MainDataManager.ts"],(function(t){var e,n,s,a;return{setters:[function(t){e=t.cclegacy,n=t.log},function(t){s=t.AliLogManager},function(t){a=t.MainDataManager}],execute:function(){e._RF.push({},"05fe2Jk1KdNF5dDV2JBXdQO","MainNetWork",void 0);var r=t("MainNetWorkClass",function(){function t(){this.cacheXhr=null,this.isOnlineEnv=this.getIsOnline(),this.BASE=this.isOnlineEnv?"https://classroom-api-online.saasp.vdyoo.com":"https://test-class-api-online.saasp.vdyoo.com",this.GET_GAME_CDN_PATH_LIST=this.BASE+"/classroom-slides/resources/cos/config-for-game",this.GET_GAME_TEMPLATE_BUNDLE_INFO=this.BASE+"/classroom-slides/game/game-templates/{gameTemplateId}/with-resource-package",this.FILE_REMOTE_URL=this.isOnlineEnv?"https://slides-resources.saasp.vdyoo.com":"https://slides-resources-test.saasp.vdyoo.com",this.FILE_REMOTE_URL_EDITOR=this.isOnlineEnv?"https://courseware-maker-1252161091.cos.ap-beijing.myqcloud.com":"https://courseware-maker-test-1252161091.cos.ap-beijing.myqcloud.com"}t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance};var e=t.prototype;return e.getIsOnline=function(){var t=a.getUrlParamByKey("env");return"prod"===t||"online"===t},e.httpRequest=function(t,e,a,r,o){var i=this;void 0===r&&(r=null),void 0===o&&(o="");var c=new XMLHttpRequest;c.open(e,t),c.timeout=1e4,c.setRequestHeader("Content-Type",a),c.withCredentials=!0,this.cacheXhr=c,c.onreadystatechange=function(){if(n("httpRequest rsp status",c.status,"        xhr.readyState",c.readyState,"        xhr.responseText",c.responseText),4==c.readyState&&c.status>=200&&c.status<=400){i.cacheXhr=null;var e=JSON.parse(c.responseText);e.errcode?(s.error("MainNetWork httpRequest 请求失败","url:"+t),r&&r(!0,null)):(s.commonLog("MainNetWork httpRequest 请求成功","url:"+t),r&&r(!1,e))}},c.ontimeout=function(e){c.abort(),i.cacheXhr=null,n("httpRequest timeout"),s.error("MainNetWork httpRequest 请求超时","url:"+t),r&&r(!0,null)},c.onerror=function(e){i.cacheXhr=null,n("httpRequest error"),s.error("MainNetWork httpRequest 请求出错","url:"+t+", error:"+e),r&&r(!0,null)},c.send(o)},e.getGameCdnPathList=function(){var t=this;return new Promise((function(e,n){t.httpRequest(t.GET_GAME_CDN_PATH_LIST,"GET","application/json;charset=utf-8",(function(t,a){if(!t&&a&&a.data&&a.data.cdnPathList){var r=a.data.cdnPathList;s.commonLog("获取管理后台游戏CDN域名成功","cdnPathList:"+r),e(r)}else s.error("获取管理后台游戏CDN域名失败","res: "+a),n(a)}))}))},e.getGameTemplateBundleInfo=function(t){var e=this;return new Promise((function(n,a){var r=e.GET_GAME_TEMPLATE_BUNDLE_INFO.replace("{gameTemplateId}",t);e.httpRequest(r,"GET","application/json;charset=utf-8",(function(t,e){if(!t&&e&&e.data){var r=e.data;s.commonLog("获取游戏模板包信息成功","gameTemplateBundleInfo:"+r),n(r)}else s.error("获取游戏模板包信息失败","res: "+e),a(e)}))}))},t}());r.instance=void 0;t("MainNetWork",r.getInstance());e._RF.pop()}}}));

System.register("chunks:///_virtual/MicroApp.ts",["cc","./env","./AliLogManager.ts","./MainDataManager.ts"],(function(e){var a,n,r,t,s;return{setters:[function(e){a=e.cclegacy,n=e.log},function(e){r=e.PREVIEW},function(e){t=e.AliLogManager},function(e){s=e.MainDataManager}],execute:function(){a._RF.push({},"19e03TnXcFBAJ9DGaN8X7rW","MicroApp",void 0);var i=function(){function e(){this.handle={}}e.getInstance=function(){return null===this._instance&&(this._instance=new e),this._instance};var a=e.prototype;return a.dispatch=function(e,a,i,c,o){void 0===i&&(i=null),void 0===c&&(c=null),void 0===o&&(o=!1);try{var l=r||s.isFromObserver()?window.parent.cocosGameMessage:s.isFromIframe()||s.isFromClassPlayer()||s.isFromGameShell()?window.gameMessageInIframe:window.cocosGameMessage;l&&l.dispatch("cocosToMcc",{pageId:s.curPageId,eventName:e,data:a,callback:i,timer:c,isRetain:o})}catch(e){n(e),t.error("MicroAppClass:catch",e)}},a.clearCacheCallbacks=function(){try{var e=r||s.isFromObserver()?window.parent.cocosGameMessage:s.isFromIframe()||s.isFromClassPlayer()||s.isFromGameShell()?window.gameMessageInIframe:window.cocosGameMessage;e&&(null==e||null==e.clearCacheCallbacks||e.clearCacheCallbacks())}catch(e){n(e),t.error("MicroAppClass:catch",e)}},a.on=function(e,a,n){if(!this.hasEvent(e,a,n)){this.handle[e]||(this.handle[e]=[]);var r={func:a,target:n};this.handle[e].push(r)}},a.off=function(e,a,n){if(this.handle[e])if(a)for(var r=0;r<this.handle[e].length;r++){var t=this.handle[e][r];if(a==t.func&&(!n||n==t.target)){this.handle[e].splice(r,1);break}}else this.handle[e]=[]},a.addDataListener=function(){try{var e=r||s.isFromObserver()?window.parent.cocosGameMessage:s.isFromIframe()||s.isFromClassPlayer()||s.isFromGameShell()||"1"===s.getUrlParamByKey("editorDebug")?window.gameMessageInIframe:window.cocosGameMessage;e&&(e.off("mccToCocos"),e.on("mccToCocos",this.dataListener.bind(this),this))}catch(e){n(e),t.error("MicroAppClass:catch",e)}},a.hasEvent=function(e,a,n){var r=this.handle[e];if(!r||r.length<=0)return!1;for(var t=0;t<r.length;t++){var s=r[t];if(a==s.func&&(!n||n==s.target))return!0}return!1},a.dataListener=function(e){var a=this.handle[e.eventName];if(a&&!(a.length<=0))for(var n=0;n<a.length;n++){var r=a[n];r.func.apply(r.target,[e.data,e.id])}},e}();i._instance=null;e("MicroApp",i.getInstance());a._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceLoadManager.ts",["cc","./AliLogManager.ts","./MainDataManager.ts","./MainNetWork.ts","./ConstValue.ts"],(function(t){var e,o,r,n,a,s,i,u,c;return{setters:[function(t){e=t.cclegacy,o=t.path,r=t.assetManager,n=t.error,a=t.ImageAsset},function(t){s=t.AliLogManager},function(t){i=t.MainDataManager},function(t){u=t.MainNetWork},function(t){c=t.EZipProcessType}],execute:function(){e._RF.push({},"654340lwjZGYYoXpgtlCmVr","ResourceLoadManager",void 0);var l=function(){function t(){this.isLoadBundleFromLocal=!0,this.isLoadResourceFromLocal=!0,this.localRootPath="",this.cdnRootPathList=[],this.loadStaticRootRes=new Map,this.bundleMaxRetryCount=0,this.bundleXhrTimeout=3e3,this.staticResMaxRetryCount=0,this.staticResXhrTimeout=3e3,this._latestSuccessHost="",this._tryLoadInfo=new Map,this._temporaryRemoteResourceMap=new Map}t.getInstance=function(){return null===this._instance&&(this._instance=new t),this._instance};var e=t.prototype;return e.loadBundle=function(t,e){s.commonLog("开始加载bundle","bundlePath: "+t);var o=this.isLoadBundleFromLocal,r=this._temporaryRemoteResourceMap.get(t);r&&(o=!1,r.onlyOnce&&this._temporaryRemoteResourceMap.delete(t));var n={tryLoadCount:1,curHostIndex:0,hostList:this.getResourceHostList(o,this.bundleXhrTimeout)};return this._tryLoadInfo.set(t,n),this.tryLoadBundle(t,e)},e.loadStaticRes=function(t,e,r,n,a){void 0===n&&(n=!1);var u=o.extname(e).toLowerCase(),c=".png"==u||".jpg"==u||".jpeg"==u||".gif"==u;if(i.isFromFullZip()&&c)return this.downloadDomImage(t,e,n);s.commonLog("开始加载静态资源","resPath: "+e);var l={tryLoadCount:1,curHostIndex:0,hostList:this.getResourceHostList(this.isLoadResourceFromLocal,this.staticResXhrTimeout)};return this._tryLoadInfo.set(t+e,l),this.tryLoadStaticRes(t,e,r,n,a)},e.downloadDomImage=function(t,e,o){void 0===o&&(o=!1),s.commonLog("开始加载静态资源:downloadDomImage","resPath: "+e);var r={tryLoadCount:1,curHostIndex:0,hostList:this.getResourceHostList(!1,this.staticResXhrTimeout)};return this._tryLoadInfo.set(t+e,r),this.tryLoadDomImage(t,e,o)},e.getResourceHostList=function(t,e){var o=[];t&&this.localRootPath&&o.push({host:this.localRootPath,timeout:e});var r=[].concat(this.cdnRootPathList);if(this._latestSuccessHost){var n=r.indexOf(this._latestSuccessHost);if(n>=0){var a=r.splice(n,1)[0];r.unshift(a)}}return 1===this.cdnRootPathList.length&&r.push(this.cdnRootPathList[0]),r.forEach((function(t,r){o.push({host:t,timeout:r>0?2*e:e})})),o},e.isCDNUrl=function(t){return this.cdnRootPathList.some((function(e){return 0===t.indexOf(e)}))},e.tryLoadBundle=function(t,e){var a=this;return new Promise((function(i,u){var c=a._tryLoadInfo.get(t),l=c.hostList[c.curHostIndex],d={maxRetryCount:a.bundleMaxRetryCount,xhrTimeout:l.timeout},m=l.host,h=o.join(m,t),L=a.transformBundleUrlByZipProcessType(h,e);s.commonLog("尝试加载bundle","第"+c.tryLoadCount+"次尝试加载bundle， url: "+L),r.loadBundle(L,d,(function(o,r){var l;return o?(n(o),c.tryLoadCount>=c.hostList.length?(s.error("尝试加载bundle失败","bundle加载失败，重试次数已用完"),s.reportEventTracking({trace_id:(null==(l=window.gameEngineCustomData)||null==(l=l.gameMain)?void 0:l.trace_id)||"null",module_type:"gameMain",name:"game_error",act:"load_bundle_failed",option:{bundlePath:t},desc:"bundle加载失败"}),u(new Error("bundle加载失败，重试次数已用完，bundlePath: "+t))):(c.tryLoadCount++,c.curHostIndex=(c.curHostIndex+1)%c.hostList.length,s.commonLog("尝试加载bundle失败","bundle加载失败，切换域名重试"),a.tryLoadBundle(t,e).then(i,u))):(s.commonLog("加载bundle成功","bundle加载成功，成功的url: "+L),a.cdnRootPathList.indexOf(m)>=0&&(a._latestSuccessHost=m),i(r))}))}))},e.tryLoadStaticRes=function(t,e,a,c,l){var d=this;return void 0===c&&(c=!1),new Promise((function(m,h){var L=d._tryLoadInfo.get(t+e),g=L.hostList[L.curHostIndex],R={maxRetryCount:d.staticResMaxRetryCount,xhrTimeout:g.timeout},f=g.host;i.isFromEditorPreview()&&(f=u.FILE_REMOTE_URL_EDITOR);var p=d.loadStaticRootRes.get(a);if(null!=p&&p.ResErr&&f===d.localRootPath)return L.tryLoadCount++,L.curHostIndex=(L.curHostIndex+1)%L.hostList.length,d.tryLoadStaticRes(t,e,a).then(m,h);var y=o.join(f,e);c&&d.isCDNUrl(y)&&(y+="?"+Date.now());var _=d.transformImgUrlByZipProcessType(y,l);s.commonLog("尝试加载静态资源","第"+L.tryLoadCount+"次尝试加载静态资源， url: "+_),r.loadRemote(_,R,(function(o,r){if(o){var i;if(n(o),L.tryLoadCount>=L.hostList.length)return s.error("尝试加载静态资源失败","静态资源加载失败，重试次数已用完 "+_),s.reportEventTracking({trace_id:(null==(i=window.gameEngineCustomData)||null==(i=i.gameMain)?void 0:i.trace_id)||"null",module_type:"gameMain",name:"game_error",act:"load_res_failed",option:{resPath:e},desc:"远程资源加载失败"}),h(new Error("静态资源加载失败，重试次数已用完，resPath: "+e));if(L.tryLoadCount++,L.curHostIndex=(L.curHostIndex+1)%L.hostList.length,s.commonLog("尝试加载静态资源失败","静态资源加载失败，切换域名重试 "+_),a&&f==d.localRootPath){var u={ResErr:!0,gameId:a};d.loadStaticRootRes.set(a,u)}return d.tryLoadStaticRes(t,e,a,c,l).then(m,h)}return s.commonLog("加载静态资源成功","静态资源加载成功，成功的url: "+_),d.cdnRootPathList.indexOf(f)>=0&&(d._latestSuccessHost=f),r.remoteUrl=_,m(r)}))}))},e.tryLoadDomImage=function(t,e,n){var i=this;return void 0===n&&(n=!1),new Promise((function(u,c){var l=i._tryLoadInfo.get(t+e),d=l.hostList[l.curHostIndex].host,m=o.join(d,e);n&&i.isCDNUrl(m)&&(m+="?"+Date.now()),s.commonLog("尝试通过Dom加载静态资源","第"+l.tryLoadCount+"次尝试加载静态资源， url: "+m);var h=function(o){var r;return l.tryLoadCount>=l.hostList.length?(s.error("尝试通过Dom加载静态资源失败","静态资源加载失败，重试次数已用完， url: "+m),s.reportEventTracking({trace_id:(null==(r=window.gameEngineCustomData)||null==(r=r.gameMain)?void 0:r.trace_id)||"null",module_type:"gameMain",name:"game_error",act:"load_res_failed",option:{resPath:e},desc:"远程资源加载失败"}),c(new Error("静态资源加载失败，重试次数已用完，resPath: "+e))):(l.tryLoadCount++,l.curHostIndex=(l.curHostIndex+1)%l.hostList.length,s.commonLog("尝试通过Dom加载静态资源失败","静态资源加载失败，切换域名重试， url: "+m),i.tryLoadStaticRes(t,e).then(u,c))};fetch(m).then((function(t){return t.blob()})).then((function(t){var o=URL.createObjectURL(t),n=new Image;n.src=o,n.onload=function(){s.commonLog("通过Dom加载静态资源成功","静态资源加载成功，成功的url: "+o);var t=new a(n);return t.remoteUrl=o,r.assets.add(e,t),i.cdnRootPathList.indexOf(d)>=0&&(i._latestSuccessHost=d),u(t)},n.onerror=function(t){return h()}})).catch((function(t){return h()}))}))},e.loadResByUrl=function(t){return s.commonLog("开始加载静态资源(不切换域名)","url: "+t),new Promise((function(e,o){r.loadRemote(t,(function(r,a){return r?(n(r),s.commonLog("加载静态资源(不切换域名)失败","加载静态资源失败，url: "+t+"; err: "+r),o(new Error("静态资源加载失败，url: "+t))):(s.commonLog("加载静态资源(不切换域名)成功","url: "+t),a.remoteUrl=t,e(a))}))}))},e.loadFullPackageResource=function(t){var e=this;return s.commonLog("开始动态加载本地resource资源","path: "+t),new Promise((function(o,a){var i={maxRetryCount:e.staticResMaxRetryCount,xhrTimeout:e.staticResXhrTimeout};r.loadRemote(t,i,(function(e,r){return e?(n(e),s.commonLog("动态加载本地resource资源失败","加载静态资源失败，url: "+t+"; err: "+e),a(new Error("动态加载本地resource资源失败，url: "+t))):(s.commonLog("动态加载本地resource资源成功","url: "+t),r.remoteUrl=t,o(r))}))}))},e.loadBundleDir=function(t,e,o){return void 0===o&&(o={}),s.commonLog("加载bundle中的文件夹","bundle: "+t.name+"; path: "+e),new Promise((function(a,i){if(!t||!e){var u="加载bundle中的文件夹失败,bundle不存在或文件夹未空，bundle: "+t+"; path: "+e;return s.error(u),i(new Error(u))}var c={__requestType__:"dir",bundle:t.name,__outputAsArray__:!0},l=Object.assign(o,c);r.loadAny(e,l,(function(t,e,o){}),(function(o,r){if(o)return s.error("加载bundle中的文件夹失败","bundle: "+t.name+"; path: "+e+"; err: "+o),n(o),i(o);s.commonLog("加载bundle中的文件夹成功","bundle: "+t.name+"; path: "+e),a(r)}))}))},e.setLoadResourceFromRemote=function(t,e){void 0===e&&(e=!1);var o={resPath:t,onlyOnce:e};this._temporaryRemoteResourceMap.set(t,o)},e.clearTemporaryRemoteResourceMap=function(){this._temporaryRemoteResourceMap.clear()},e.transformBundleUrlByZipProcessType=function(t,e){if(!t.startsWith(this.localRootPath)||t.startsWith("/")||t.startsWith("./"))return t;var r=t.replace(/\/+$/,""),n=o.basename(r);return e===c.webp?t.replace(new RegExp(n+"$"),"webp/"+n):e===c.quality?t.replace(new RegExp(n+"$"),"quality/"+n):t},e.transformImgUrlByZipProcessType=function(t,e){var o=[".png",".jpg",".jpeg"];return o.some((function(e){return t.endsWith(e)}))&&t.startsWith(this.localRootPath)?e===c.webp?t.replace(new RegExp(o.join("|")),"_webp.webp"):e===c.quality?t.replace(new RegExp("("+o.join("|")+")"),"_quality$1"):t:t},t}();l._instance=null;t("ResourceLoadManager",l.getInstance());e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});